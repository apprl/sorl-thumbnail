#!/bin/bash

#
# Bash script to kick off the ApparelRow Product Importer with the correct
# environment.
#
# Usage:
#   bin/import
# - or -
#   bin/import name-of-feed-vendor
#
# Feeds from all configured FeedVendors will be imported, unless a name is specified
# as sole argument.
#

if [[ -z $PROJDIR ]]; then
    PROJDIR="`dirname $0`/.."
fi

if [[ -e $PROJDIR/bin/activate ]]; then
    . $PROJDIR/bin/activate
fi

cd "$PROJDIR/releases/current"

# Refresh fx rates
$PROJDIR/bin/python manage.py arfxrates --refresh --no_update --solr

# Run new the imp importer
$PROJDIR/bin/python manage.py run_importer

# Update fx rates
$PROJDIR/bin/python manage.py arfxrates --refresh --solr

# Brand updates
$PROJDIR/bin/python manage.py brand_updates
