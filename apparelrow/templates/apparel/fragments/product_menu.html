{% load i18n apparel_extras mptt_tags %}

{% if user_id and user_gender != 'A' %}

{% elif user_id and user_gender == 'A' %}
<h2>
    {% trans "Filter products" %}
    <a id="reset" class="reset" href=""{% if not request.GET %} style="display: none;"{% endif %}>{% trans "Reset all" %}</a>
</h2>
<ul id="product-gender">
    <li class="first"><a href="">{% trans "All" %}</a></li>
    <li class="women"><a id="option-W" href="?gender=W">{% trans "Women" %}</a></li>
    <li class="men"><a id="option-M" href="?gender=M">{% trans "Men" %}</a></li>
</ul>
{% else %}
<h2>
    {% trans "Filter products" %}
    <a id="reset" class="reset" href=""{% if not request.GET %} style="display: none;"{% endif %}>{% trans "Reset all" %}</a>
</h2>
<ul id="product-gender">
    <li class="first women"><a id="option-W"{% if gender == "W" %} class="selected"{% endif %} href="/shop/women/">{% trans "Women" %}</a></li>
    <li class="last men"><a id="option-M"{% if gender == "M" %} class="selected"{% endif %} href="/shop/men/">{% trans "Men" %}</a></li>
</ul>
{% endif %}

<h2 id="product-category-header">
    {% trans "Choose category" %}
    {% if user_id and user_gender != 'A' %}
    <a id="reset" class="reset" href=""{% if not request.GET %} style="display: none;"{% endif %}>{% trans "Reset all" %}</a>
    {% else %}
    <a class="reset" href="">{% trans "Reset" %}</a>
    {% endif %}
</h2>
{% for category, structure in categories_all|tree_info %}
    {% if structure.new_level %}
        <ul{% if forloop.first %} id="product-category"{% endif %} class="level-{{Â category.get_level }}">
    {% else %}
        </li>
    {% endif %}
        <li class="{% if forloop.first %}first{% endif %}{% if forloop.last %}last{% endif %}{% if categories and category.id not in categories %} to_filter{% endif %}">
        <a data-order="{{ category.name_order }}" id="category-{{ category.id }}"{% if category.id in selected_categories %} class="selected"{% endif %} href="?category={{ category.id }}">{{ category.name }} <span class="category-count">({{ categories|getdictattribute:category.id }})</span></a>
    {% for level in structure.closed_levels %}</li></ul>{% endfor %}
{% endfor %}

{% block product_options %}{% endblock %}
