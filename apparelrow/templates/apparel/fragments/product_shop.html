{% load l10n i18n thumbnail thumbnail_extras apparel_extras buy_extras %}

<div class="thumbnail product-medium" id="product-{{ object.id }}" data-id="{{ object.id }}">
    {% thumbnail object.product_image "280x320" crop=False format='PNG' transparent=True as im %}
    <img src="{{ im.url }}" alt="{{ object.alt_text }}" width="{{ im.width }}" height="{{ im.height }}" style="margin:{{ im|positive_margin:'280x320' }}">
    {% endthumbnail %}
    <div class="hover">
        <a class="btn btn-default btn-product-like" href="#" data-dialog-url="{% url 'dialog-like-product' %}" data-like-url="{% url 'product-action' object.id 'like' %}" data-unlike-url="{% url 'product-action' object.id 'unlike' %}" data-slug="{{ object.slug }}" data-id="{{ object.id }}" data-vendor="{{ object.default_vendor.vendor }}" data-price="{{ object.default_vendor.lowest_price_in_sek|floatformat:0 }}">{% trans "Like" %}</a>
        <a class="btn btn-default btn-product-info" href="{{ object.get_absolute_url }}">{% trans "Info" %}</a>
        {% if object.default_vendor and object.default_vendor.availability != 0 and object.availability %}
        <a class="btn btn-success btn-product-buy" target="_blank" href="{% buy_url object.id object.default_vendor '0' 'Shop' %}" data-slug="{{ object.slug }}" data-vendor="{{ object.default_vendor.vendor }}" data-price="{{ object.default_vendor.lowest_price_in_sek|floatformat:0 }}">{% trans "Buy" %}</a>
        {% endif %}
    </div>
    <div class="caption">
        <h3><a href="{{ object.get_absolute_url }}">{{ object.manufacturer }}</a></h3>
        {% if object.default_vendor and object.default_vendor.availability != 0 and object.availability %}
        <p>
            {% if object.default_vendor.discount_price %}
            <span class="discount-price" data-price="{{ object.default_vendor.original_discount_price|unlocalize }}" data-currency="{{ object.default_vendor.original_currency }}">{{ object.default_vendor.original_discount_price|floatformat:0|apprl_intcomma }} {{ object.default_vendor.original_currency }}</span>
            <span class="price discounted" data-price="{{ object.default_vendor.original_price|unlocalize }}" data-currency="{{ object.default_vendor.original_currency }}">{{ object.default_vendor.original_price|floatformat:0|apprl_intcomma }} {{ object.default_vendor.original_currency }}</span>
            {% else %}
            <span class="price" data-price="{{ object.default_vendor.original_price|unlocalize }}" data-currency="{{ object.default_vendor.original_currency }}">{{ object.default_vendor.original_price|floatformat:0|apprl_intcomma }} {{ object.default_vendor.original_currency }}</span>
            {% endif %}
        </p>
        {% else %}
        <span class="sold-out">SOLD OUT</span>
        {% endif %}
        {% if has_looks %}
        <p><a class="looks" data-slug="{{ object.slug }}" data-vendor="{{ object.default_vendor.vendor }}" href="{% url 'product-look-list' contains=object.slug %}">{% trans "See looks »" %}</a></p>
        {% endif %}
    </div>
</div>
