{% extends 'profile/base.html' %}
{% load i18n %}
{% load humanize %}
{% load voting_tags %}
{% load trackback_tags %}

{% block 'extra-styles' %}
    <link rel="pingback" href="{% get_pingback_url %}" />
    {% get_trackback_rdf_for object %}
    <style type="text/css">
        .collage {
            position: relative;
            height: 450px;
            overflow: hidden;
        }
        .tooltip {
            display: none;
            z-index: 1100;
            padding: 1em;
        }
    </style>
{% endblock 'extra-styles' %}

{% block 'extra-scripts' %}
<script type="text/javascript">
    jQuery(document).ready(function() {
        jQuery('.product').tooltip({
            effect: 'slide',
            relative: true,
            delay: 500,
            offset: [30, 0],
        });
       if(jQuery('#comments textarea').val() == '') { jQuery('#comments button').hide() }
       jQuery('#comments textarea').focus(function() { jQuery('#comments button').slideDown() });
       jQuery('#comments textarea').blur(function() { if(jQuery(this).val() == '' ) { jQuery('#comments button').fadeOut() } });
//            jQuery('#comments textarea').autogrow();
        jQuery('#comments form').submit(function() {
            jQuery.ajax({
                type: this.method,
                url: this.action,
                data: jQuery(this).serialize(),
                dataType: 'json',
                success: function(data, statusText, req) {
                    jQuery('#comments textarea').val('');
                    jQuery('#comments button').hide();
                    jQuery('#comments > ul').append(data.html).slideDown();
                },
            });
            return false;
        });
    });
</script>
{% endblock 'extra-scripts' %}

{% block body-classes %}look two-columns{% endblock %}

{% block body %}
<div class="sidebar">
    <h2>Sidebar</h2>
    <p>
    {% blocktrans count object.look_products.all|length as number %}
    {{ number }} article
    {% plural %}
    {{ number }} articles
    {% endblocktrans %}
    {{ object.total_price }} SEK
    </p>
    {% if object.description %}<p>{{ object.description }}</p>{% endif %}
    <p>{% trans "Created" %} {{ object.created|naturalday:"Y-m-d" }}</p>
    <p>{% include 'apparel/fragments/likes.html' %}</p>
</div>
<div id="content">
    <h2>{{ object.title }}</h2>
    <div class="collage">
        {% include 'apparel/fragments/look_collage.html' %}
        <form method="post" action="{% url like-look object.slug "up" %}">
            <button type="submit" name="like" id="like">{% trans "Like" %}</button>
        </form>
    </div>
    {% ifequal object.user user %}
    <a href="{% url apparel.views.look_edit object.id %}">{% trans "Edit look" %}</a>
    {% endifequal %}
    {% include 'apparel/fragments/comments.html' %}
    <h2>{% trans "Articles in this look" %}</h2>
    <div id="lookproducts">
        {% with object.products.all as products %}
        {% include 'apparel/fragments/product_row.html' %}
        {% endwith %}
    </div>
</div>
{% endblock body %}
