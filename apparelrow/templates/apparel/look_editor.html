{% extends 'base.html' %}
{% load static from staticfiles %}
{% load i18n apparel_extras thumbnail cache compressed %}

{% block extra-title %}{% trans "Edit" %} {{ object.title }} {% trans "by" %} {{ object.user }} | {% trans "Looks" %} | {% endblock %}

{% block extra-styles %}
<!--<link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/smoothness/jquery-ui.css" rel="stylesheet" />-->
{% endblock %}

{% block body-classes %}look-editor{% endblock %}
{% block body-header %}
<div id="body-header">
    <div class="column_one">
        <h1>{% if component == 'collage' %}{% trans "Create collage look" %}{% else %}{% trans "Create photo look" %}{% endif %}</h1>
        {{ form.title }}
    </div>
</div>
{% endblock body-header %}
{% block body %}

    <div id="content" class="group">
        <div class="button-container">
            <button class="btn btn-upper btn-save" name="look_save">{% trans "Save" %}</button>
            <button class="btn btn-upper btn-positive btn-publish" name="look_publish">{% trans "Publish" %}</button>
            {% if object and object.slug %}
            <button class="btn btn-upper btn-delete" name="look_delete">{% trans "Delete look" %}</button>
            {% else %}
            <button class="btn btn-upper btn-reset" name="look_reset">{% trans "Reset look" %}</button>
            {% endif %}
        </div>

        <div id="edit-look"></div>

        <div id="product-chooser">
            <ul id="product-tabs" class="group">
                <li><a class="tab-likes{% if request.user.is_authenticated %} selected{% endif%}"{% if request.user.is_authenticated %} data-user="{{ request.user.id }}"{% endif %} href="#likes">{% trans "Your ♥" %}</a>
                <li><a class="tab-all{% if not request.user.is_authenticated %} selected{% endif%}" href="#all">{% trans "All products" %}</a></li>
            </ul>
            <div id="product-filter">
                <div class="main-filters">
                    <input type="search" name="q" placeholder="{% trans "Search for your product here.." %}">
                    <label><input type="radio" name="gender" value="W"{% if APPAREL_GENDER == 'W' %} checked{% endif %}> {% trans "Women" %}</label>
                    <label><input type="radio" name="gender" value="M"{% if APPAREL_GENDER == 'M' %} checked{% endif %}> {% trans "Men" %}</label>
                    <div class="sub-filters"></div>
                </div>
            </div>
            <ul id="product-list"></ul>
        </div>
    </div>

    <script type="text/template" id="edit_look_template">
        <div class="look-container" id="<%= look_type %>"<% if(look_type == 'photo' && look.image) { %> style="background-image: url('<%= look.image %>');"<% } %>>
            <div class="look_data">Look data: <%= JSON.stringify(look) %></div>
        </div>
        <div class="look-description">
            <h2>{% trans "Description" %}</h2>
            {{ form.description }}
        </div>
    </script>

    <script type="text/template" id="look_component_photo">
        <div class="hotspot" style="left: <%= left %>px; top: <%= top %>px;">
            <a href="#" class="delete"></a>
        </div>
    </script>

    <script type="text/template" id="look_component_collage">
        <div style="<%= styles %>" data-id="<%= product_id %>" data-slug="<%= product_slug %>">
            <a href="#" class="delete"></a>
        </div>
    </script>

    <script type="text/template" id="temporary_image_form_template">
        <form enctype="multipart/form-data" action="{% url temporary-image %}" method="POST" id="temporaryimage">
            {% csrf_token %}
            <div class="look-empty"{% if object.image %} style="display: none"{% endif %}>
                <p>{% trans "Upload a photo to create a tagged image" %}</p>
                <div class="message">
                    <div class="upload-field">
                        <span><input type="file" name="image_file"></span>
                    </div>
                    <button type="submit">{% trans "Upload" %}</button>
                </div>
            </div>
        </form>
    </script>

    <script type="text/template" id="product_small_template">
        <div class="product-small product-container">
            <a class="image-small" href="#">
                <img src="/media/<%= image_small %>">
            </a>
            <div class="hover">
                <a class="btn btn-upper btn-block btn-info" href="#">{% trans "Info" %}</a>
                <a class="btn btn-upper btn-block btn-positive btn-add" href="#">{% trans "Add" %}</a>
            </div>
            <div class="caption">
                <h4><%= brand_name %></h4>
                <% if(!availability) { %>
                <span class="sold-out">SOLD OUT</span>
                <% } else { %>
                <p>
                    <% if(discount) { %>
                        <span class="discount-price"><%= formatNumber(discount_price) %> <%= currency %></span>
                        <span class="price discounted"><%= formatNumber(price) %> <%= currency %></span>
                    <% } else { %>
                        <span class="price"><%= formatNumber(price) %> <%= currency %></span>
                    <% } %>
                </p>
                <% } %>
            </div>
        </div>
    </script>

    <script type="text/javascript">
        var external_look_type = '{{ component }}';
        var external_look_id = {% if object %}{{ object.id }}{% else %}-1{% endif %};
    </script>
    <!--<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js"></script>-->
    {% compressed_js 'look_editor' %}

{% endblock body %}
