{% extends "base.html" %}
{% load i18n apparel_extras %}

{% block head-data %} prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{ FACEBOOK_OG_TYPE }}: http://ogp.me/ns/fb/{{ FACEBOOK_OG_TYPE }}#"{% endblock head-data %}

{% block extra-styles %}
    <meta property="og:title" content="{{ profile.display_name }}"/>
    <meta property="og:type" content="profile"/>
    <meta property="og:image" content="{{ avatar_absolute_uri }}"/>
    <meta property="og:url" content="{{ request.build_absolute_uri }}"/>
    <meta property="og:description" content="{% if profile.about %}{{ profile.about }}{% else %}{% endif %}"/>
    <meta property="og:site_name" content="{{ CURRENT_NAME }}"/>
    <meta property="fb:app_id" content="{{ FACEBOOK_APP_ID }}"/>
    {% if profile.facebook_uid %}
    <meta property="fb:profile_id" content="{{ profile.facebook_uid }}"/>
    {% endif %}
{% endblock extra-styles %}

{% block body-header %}
{% with likes_url=profile.url_likes updates_url=profile.url_updates looks_url=profile.url_looks followers_url=profile.url_followers following_url=profile.url_following %}
<div id="body-header">
    <div class="column_one">
        <h1 class="max-width">{{ profile.display_name }}</h1>
    </div>
    <div class="column_two">
        <ul>
            <li>
            {% if profile and profile.is_brand %}
                {% url brand-likes-men profile.slug as likes_url_men %}
                {% url brand-likes-women profile.slug as likes_url_women %}
                <a class="{% if request.path == likes_url or request.path == likes_url_men or request.path == likes_url_women %}selected{% else %}first{% endif %}" href="{{ likes_url }}">{% trans "Shop" %}</a>
            {% else %}
                <a class="{% if request.path == likes_url %}selected{% else %}first{% endif %}" href="{{ likes_url }}">{% trans "Likes" %}</a>
            {% endif %}
            </li>
            <li>
                <a class="{% if request.path == updates_url %}selected{% endif %}" href="{{ updates_url }}">{% trans "Updates" %}</a>
            </li>
            <li>
                <a class="{% if request.path == looks_url %} selected{% endif %}" href="{{ looks_url }}">{% trans "Looks" %}</a>
            </li>
            <li>
                <a class="{% if request.path == followers_url %} selected{% endif %}" href="{{ followers_url }}">{% trans "Followers" %}</a>
            </li>
            <li>
                <a class="last{% if request.path == following_url %} selected{% endif %}" href="{{ following_url }}">{% trans "Following" %}</a>
            </li>
        </ul>
    </div>
</div>
{% endwith %}
{% endblock body-header %}

{% block body-classes %}three-columns profile{% endblock body-classes %}
{% block body %}
    <div class="sidebar">
        <div id="profile-image">
            <a href="{{ profile.get_absolute_url }}" class="profile-link"><img src="{{ profile.avatar_large }}" class="avatar large"></a>
            {% if user.is_authenticated and user == profile.user %}
                <a href="#edit" class="btn btn-small btn-block btn-positive btn-edit">{% trans "Change picture" %}</a>
                <a href="#cancel" class="btn btn-small btn-block btn-negative btn-cancel">{% trans "Cancel" %}</a>
                {% with "multipart/form-data" as form_enctype %}
                {% include 'profile/fragments/change_image_form.html' %}
                {% endwith %}
            {% endif %}
        </div>
        <p>
            {% trans "Member since" %} {{ profile.user.date_joined|date:"SHORT_DATE_FORMAT" }}
        </p>
        <div id="sidebar-profile-info">
            {% with likes_url=profile.url_likes looks_url=profile.url_looks followers_url=profile.url_followers following_url=profile.url_following %}
            {% if not profile.is_brand %}
            <p><a href="{{ likes_url }}">{% blocktrans count products as prod %}Likes {{ prod }} product{% plural %}Likes {{ prod }} products{% endblocktrans %}</a></p>
            {% else %}
            <p><a href="{{ likes_url }}">{% blocktrans count products as prod %}{{prod}} product{% plural %}{{prod}} products{% endblocktrans %}</a></p>
            {% endif %}
            <p>
                <a href="{{ looks_url }}">
                {% blocktrans count profile.looks as looks %}
                    {{ looks }} look
                {% plural %}
                    {{ looks }} looks
                {% endblocktrans %}
                </a>
            </p>
            <p>
                <a href="{{ followers_url }}">{% trans "Followed by" %} {{ profile.followers_count }}</a>
            <p>
                <a href="{{ following_url }}">{% trans "Following" %} {{ following }}</a>
            </p>
            {% endwith %}
        </div>
        {% if profile.about %}<p class="description">{{ profile.about|urlize|linebreaksbr }}</p>{% endif %}
        {% include 'apparel/fragments/follow.html' with classes="btn btn-upper btn-block" %}
        {% if profile.is_brand %}
        <p><a class="btn btn-upper btn-block" href="{% gender_url APPAREL_GENDER 'shop' %}#manufacturer={{ profile.brand.id }}">{% trans "Filter products" %}</a></p>
        {% endif %}
    </div>
    {% block extended_content %}
    <div id="content">
    {% block content %}
    {% endblock content %}
    </div>

    <div class="sidebar last">
    {% block profile_right_sidebar %}
        {% if recent_looks %}
        <h2>{% blocktrans with profile.display_name as name %}{{ name }}'s latest looks{% endblocktrans %}</h2>
        <ul class="looks group">
        {% for object in recent_looks %}
            <li>{% include 'apparel/fragments/look_sidebar.html' %}</li>
        {% endfor %}
        </ul>
        {% endif %}
    {% endblock %}
    </div>
    {% endblock extended_content %}
{% endblock %}
