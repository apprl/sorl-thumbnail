{% extends "base.html" %}
{% load i18n apparel_extras %}

{% block head-data %} prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {{ FACEBOOK_OG_TYPE }}: http://ogp.me/ns/fb/{{ FACEBOOK_OG_TYPE }}#"{% endblock head-data %}

{% block extra-styles %}
    <meta property="og:title" content="{{ profile.display_name }}"/>
    <meta property="og:type" content="profile"/>
    <meta property="og:image" content="{{ avatar_absolute_uri }}"/>
    <meta property="og:url" content="{{ request.build_absolute_uri }}"/>
    <meta property="og:description" content="{% if profile.about %}{{ profile.about }}{% else %}{% endif %}"/>
    <meta property="og:site_name" content="{{ CURRENT_NAME }}"/>
    <meta property="fb:app_id" content="{{ FACEBOOK_APP_ID }}"/>
    {% if profile.facebook_user_id %}
    <meta property="fb:profile_id" content="{{ profile.facebook_user_id }}"/>
    {% endif %}
    <link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/smoothness/jquery-ui.css" rel="stylesheet" />
{% endblock extra-styles %}

{% block 'extra-scripts' %}
{% if request.user.is_authenticated and request.user == profile %}
<script type="text/javascript">
$(document).ready(function() {
    $('.profile-header .btn-change-description').enableEditable();
});
</script>
{% endif %}
{% endblock 'extra-scripts' %}

{% block body-classes %}profile-page{% endblock body-classes %}
{% block full-body %}
<div class="profile-header">
    <div class="container">

        <div class="row">
            <div class="col-sm-2">
                <div id="profile-image">
                    <a href="{{ profile.get_absolute_url }}"><img src="{{ profile.avatar_large }}" class="img-responsive"></a>
                    {% if request.user.is_authenticated and request.user == profile %}
                    <a href="#edit" class="btn btn-success btn-sm btn-block btn-edit" style="display: none;">{% trans "Change picture" %}</a>
                    <a href="#cancel" class="btn btn-danger btn-sm btn-block btn-cancel" style="display: none;">{% trans "Cancel" %}</a>
                    {% include 'profile/fragments/change_image_form.html' with form_enctype='multipart/form-data' %}
                    {% endif %}
                </div>
            </div>
            <div class="col-sm-10 profile-content">
                <h1>{{ profile.display_name }}</h1>
                {% if request.user.is_authenticated and request.user == profile %}
                <a class="btn btn-primary btn-create-shop" data-slug="{{ request.user.slug }}" href="{% url 'create-shop' %}">{% trans "Create a shop on your site" %}</a>
                {% else %}
                {% include 'apparel/fragments/follow.html' %}
                {% endif %}
                {% if profile and profile.is_brand and profile.translated_manual_about %}
                <p class="description">{{ profile.translated_manual_about|urlize_target_blank|linebreaksbr }}</p>
                {% else %}
                <p class="description">{% if profile.about %}{{ profile.about|urlize_target_blank|linebreaksbr }}{% else %}{% if request.user.is_authenticated and request.user == profile %}{% trans "Add your description by clicking here." %}{% endif %}{% endif %}</p>
                {% endif %}

                {% if request.user.is_authenticated and request.user == profile %}
                <form id="description-form" method="post" action="{% url 'settings-save-description' %}" style="display: none;">
                    {% csrf_token %}
                    <div class="form-group">
                        <textarea class="form-control" rows="5" name="description">{{ profile.about }}</textarea>
                    </div>
                    <button class="btn btn-success btn-save-description">{% trans "Save description" %}</button>
                    <button class="btn btn-danger btn-cancel-description">{% trans "Cancel" %}</button>
                </form>
                <a class="btn btn-primary btn-change-description" href="#">{% trans "Change description" %}</a>
                {% endif %}
            </div>
        </div>

        <div class="profile-navigation row">
            <div class="col-lg-12">
                {% with likes_url=profile.url_likes looks_url=profile.url_looks likedlooks_url=profile.url_likedlooks brandlooks_url=profile.url_brandlooks shops_url=profile.url_shops followers_url=profile.url_followers following_url=profile.url_following %}
                <ul class="list-inline">
                    <li>
                    {% if profile and profile.is_brand %}
                        {% url 'brand-likes-men' profile.slug as likes_url_men %}
                        {% url 'brand-likes-women' profile.slug as likes_url_women %}
                        <a{% if request.path == likes_url or request.path == likes_url_men or request.path == likes_url_women %} class="selected"{% endif %} href="{{ likes_url }}">
                            {% blocktrans count products as product_count %}{{product_count}} Item{% plural %}{{product_count}} Items{% endblocktrans %}
                        </a>
                    {% else %}
                        <a{% if request.path == likes_url %} class="selected"{% endif %} href="{{ likes_url }}">
                            {% blocktrans count products as product_count %}{{product_count}} Item{% plural %}{{product_count}} Items{% endblocktrans %}
                        </a>
                    {% endif %}
                    </li>
                    <li>
                        <a{% if request.path == looks_url %} class="selected"{% endif %} href="{{ looks_url }}">
                            {% blocktrans count profile.looks as look_count %}{{look_count}} Look{% plural %}{{look_count}} Looks{% endblocktrans %}
                        </a>
                    </li>
                    {% if profile == request.user %}
                    <li>
                        <a{% if request.path == likedlooks_url %} class="selected"{% endif %} href="{{ likedlooks_url }}">
                            {% blocktrans count profile.look_likes_count as look_count %}{{look_count}} Liked Look{% plural %}{{look_count}} Liked Looks{% endblocktrans %}
                        </a>
                    </li>
                    {% endif %}
                    {% if profile.is_brand %}
                    <li>
                        <a{% if request.path == brandlooks_url %} class="selected"{% endif %} href="{{ brandlooks_url }}">
                            {% blocktrans count profile.look_likes_count as look_count %}{{look_count}} Look using this Brand{% plural %}{{look_count}} Looks using this Brand{% endblocktrans %}
                        </a>
                    </li>
                    {% endif %}
                    {% if profile.shops %}
                    <li>
                        <a{% if request.path == shops_url %} class="selected"{% endif %} href="{{ shops_url }}">
                            {% blocktrans count profile.shops as shop_count %}{{shop_count}} Shop{% plural %}{{shop_count}} Shops{% endblocktrans %}
                        </a>
                    </li>
                    {% endif %}
                    <li>
                    <a{% if request.path == followers_url %} class="selected"{% endif %} href="{{ followers_url }}">
                            {% blocktrans count profile.followers_count as followers_count %}{{followers_count}} Follower{% plural %}{{followers_count}} Followers{% endblocktrans %}
                        </a>
                    </li>
                    <li>
                    <a{% if request.path == following_url %} class="selected"{% endif %} href="{{ following_url }}">
                            {% blocktrans count following as following_count %}{{following_count}} Following{% plural %}{{following_count}} Following{% endblocktrans %}
                        </a>
                    </li>
                </ul>
                {% endwith %}
            </div>
        </div>

    </div>
</div>

<div class="container">
    {% block content %}{% endblock content %}
</div>
{% endblock %}
