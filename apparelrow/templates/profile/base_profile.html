{% extends "base.html" %}
{% load i18n %}

{% block 'extra-scripts' %}

    <script type="text/javascript">
        jQuery(document).ready(function() {
            jQuery('.inline-delete-look').click(function(event) {
                var title = jQuery(this).prev('a').attr('title');
                var href = jQuery(this).attr('href');
                var li = jQuery(this).closest('li');
                create_modal_dialog(
                    '{% trans "Are you sure?" %}',
                    ['{% trans "Do you really want to delete look" %} <span class="bold">' + title + '</span>?'],
                    function (modal_dialog) {
                        jQuery.ajax({
                            url: href,
                            success: function(data) {
                                if (data.data) {
                                    li.remove();
                                }
                            },
                            complete: function() { modal_dialog.close(); }
                        });
                    },
                    function (modal_dialog) { modal_dialog.close(); }
                );
                event.preventDefault();
            });

            {% url profile.views.looks user.username as looks_url %}
            {% ifequal request.path looks_url %}
            jQuery('.inline-delete-look').show();
            {% endifequal %}
        });
    </script>

{% endblock 'extra-scripts' %}

{% block body-classes %}three-columns profile{% endblock body-classes %}
{% block body %}
    <div id="profile-nav">
        <ul>
            {% include 'profile/fragments/menu_items.html' %}
        </ul>
    </div>
    <div class="sidebar">
        <div id="profile-image">
            <a href="{{ profile.get_absolute_url }}" class="profile-link"><img src="{{ profile.avatar_large }}" class="avatar large"></a>
            {% if user.is_authenticated and user == profile.user %}
                <button class="edit">{% trans "Change picture" %}</button>
                <button class="cancel-edit">{% trans "Cancel" %}</button>
                {% with "multipart/form-data" as form_enctype %}
                {% include 'profile/fragments/change_image_form.html' %}
                {% endwith %}
            {% endif %}
        </div>
        <h1><a href="{{ profile.get_absolute_url }}" class="profile-link">{{ profile.display_name }}</a></h1>
        <p>
            {% trans "Member since" %} {{ profile.user.date_joined|date:"SHORT_DATE_FORMAT" }}
        </p>
        {% url apparel.browse.browse_profile profile.user.username as likes_url %}
        {% url profile.views.looks profile.user.username as looks_url %}
        {% url profile.views.followers profile.user.username as followers_url %}
        {% url profile.views.following profile.user.username as following_url %}
        <p>
            <a href="{{ likes_url }}">{% blocktrans count products as prod %}Likes {{ prod }} product{% plural %}Likes {{ prod }} products{% endblocktrans %}</a>
        </p>
        <p>
        <a href="{{ looks_url }}">
            {% blocktrans count profile.looks as looks %}
                {{ looks }} look
            {% plural %}
                {{ looks }} looks
            {% endblocktrans %}
        </a>
        </p>      
        <p>
            <a href="{{ followers_url }}">{% trans "Followed by" %} {{ profile.followers_count }}</a>
        <p>
            <a href="{{ following_url }}">{% trans "Following" %} {{ following }}</a>
        </p>
        {% if profile.about %}<p class="description">{{ profile.about|urlize|linebreaksbr }}</p>{% endif %}
        <p class="large_follow">{% include 'apparel/fragments/follow.html' %}</p>
    </div>
    <div id="content">
    {% block content %}
    {% endblock content %}
    </div>
    <div class="sidebar last">
    {% block profile_right_sidebar %}
        <h2>{% blocktrans with profile.display_name as name %}{{ name }}'s latest looks{% endblocktrans %}</h2>
        {% with recent_looks as looks %}
            {% include 'apparel/fragments/looks_sidebar.html' %}
        {% endwith %}
    {% endblock %}
    </div>
{% endblock %}
