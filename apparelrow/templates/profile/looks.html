{% extends "profile/base_profile.html" %}
{% load i18n %}

{% block extra-title %}{{ profile.display_name }} - {% trans "Looks" %} | {% endblock %}
{% block 'extra-scripts' %}
<script type="text/javascript">
    jQuery(document).ready(function() {
        jQuery(document).on('click', '.large-looks .btn-delete', function(event) {
            var title = jQuery(this).prev('a').attr('title');
            var href = jQuery(this).attr('href');
            var li = jQuery(this).closest('li');
            create_modal_dialog(
                '{% trans "Are you sure?" %}',
                ['{% trans "Do you really want to delete look" %} <span class="bold">' + title + '</span>?'],
                function (modal_dialog) {
                    jQuery.ajax({
                        url: href,
                        success: function(data) {
                            if (data.data) {
                                li.remove();
                            }
                        },
                        complete: function() { modal_dialog.close(); }
                    });
                },
                function (modal_dialog) { modal_dialog.close(); }
            );
            event.preventDefault();
        });

        jQuery(document).on('click', '.btn-publish', function(e) {
            var $this = $(this);
            var href = $this.attr('href');
            var $a = $this.parents('.look-container').find('h3 a');
            create_modal_dialog(
                '{% trans "Publish look" %}',
                ['{% trans "Do you want to publish this look?" %}'],
                function (modal_dialog) {
                    $.ajax({url: href,
                            success: function(data) {
                                $this.remove();
                                var text = $a.text();
                                if(text.indexOf('(') > -1) {
                                    $a.text(text.substring(0, text.lastIndexOf('(') - 1));
                                }
                            },
                            complete: function() { modal_dialog.close(); }
                        });
                },
                function (modal_dialog) { modal_dialog.close(); }
            );
            return false;
        });

    });
</script>
{% endblock 'extra-scripts' %}

{% block body-classes %}profile profile-looks{% endblock body-classes %}
{% block content %}
    {% if current_page.object_list %}
        {% include 'apparel/fragments/look_list.html' %}
    {% else %}
        <div class="empty">
        {% if profile == request.user %}
            <div class="message warning">
                <p>{% trans "All looks that you create end up here." %}</p>
                <a class="btn btn-block btn-positive btn-upper" href="{% url 'look-create' %}">{% trans "+ Create look!" %}</a>
            </div>
        {% else %}
            <div class="message warning">{% blocktrans with profile.display_name as display_name %}{{ display_name }} has not created any looks yet.{% endblocktrans %}</div>
        {% endif %}
        </div>
    {% endif %}
{% endblock %}
