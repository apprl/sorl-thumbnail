{% extends 'base.html' %}
{% load i18n %}
{% load apparel_extras %}

{% block 'extra-scripts' %}
    <script type="text/javascript" src="{{ MEDIA_URL }}/js/filtersetup.js"></script>
    <script type="text/javascript">
        var pricerange = {
            min: {{ pricerange.min }},
            max: {{ pricerange.max }}
        };
        
        var MAX_ANIMATE = 7;
        var ANIMATION_SPEED = 1000;
        
        jQuery(document).ready(function() {
            jQuery('.tabs').tabs('#featured-looks > li', {
                initialIndex: 0,
                effect: 'fade',
                fadeInSpeed: ANIMATION_SPEED,
                fadeOutSpeed: ANIMATION_SPEED,
                rotate: true,
                history: true
            })
            .data('timerImageIndex', 0)
            .bind('onBeforeClick', function(e, idx) {
                var tabs = jQuery('.tabs').data('tabs');
                var tab  = tabs.getCurrentTab();
                
                window.clearTimeout(tab.data('tabAnimationTimer'));
                tab.data('tabAnimationIndex', 1);
                for(var i = 1; i <= MAX_ANIMATE; i++)
                    tab.removeClass('tab-animation-' + i);
            })
            .bind('onClick', function(e, idx) {
                animateTab();
            })
            .slideshow()
            ;
        });
        function animateTab() {
            var tabs = jQuery('.tabs').data('tabs');
            var tab  = tabs.getCurrentTab();
            var i = tab.data('tabAnimationIndex');
            
            if(i <= MAX_ANIMATE) {
                if(i > 1) tab.removeClass('tab-animation-' + (i - 1));
                tab.addClass('tab-animation-' + i);
                tab.data('tabAnimationIndex', ++i);
                tab.data('tabAnimationTimer', window.setTimeout(animateTab, ANIMATION_SPEED));
                
                return;
            }
            tabs.next();
        }
    </script>
{% endblock 'extra-scripts' %}

{% block body-classes %}three-columns{% endblock body-classes %}

{% block body %}
    <div class="sidebar">
        {% include 'apparel/fragments/product_menu.html' %}
    </div>
    <div id="content">
        <h2>{% trans "Current" %}</h2>
        <ul id="featured-looks">
            <li><img src="{{ MEDIA_URL }}/images/example-look.png" /></li>
            <li><img src="{{ MEDIA_URL }}/images/example-look2.jpg" /></li>
            <li><img src="{{ MEDIA_URL }}/images/example-look3.jpg" /></li>
        </ul>
        <div id="switchlook">
            <div class="info">
                <h3>{% trans "Best looks of the month" %}</h3>
                <p>{% trans "Take a look at the highlights of last month" %}</p>
            </div>
            <div class="nav">
                <a class="backward" href="#prev">{% trans "Previous" %}</a>
                <ul class="tabs">
                    <li><a id="l1" href="#look1">Look 1</a></li>
                    <li><a id="l2" href="#look2">Look 2</a></li>
                    <li><a id="l3" href="#look3">Look 3</a></li>
                </ul>
                <a class="forward" href="#next">{% trans "Next" %}</a>
            </div>
        </div>
    </div>
    <div class="sidebar last">
        <h2>{% trans "Popular looks" %}</h2>
        <ul class="looks">
        {% for look in popular_looks %}
            {% with look|first as object %}
            {% cycle '<li>' '<li class="last">' %}{% include 'apparel/fragments/look_collage_small.html' %}</li>
            {% endwith %}
        {% endfor %}
        </ul>
    </div>
{% endblock body %}

